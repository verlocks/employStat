```{r, echo=FALSE}
library(readxl)
library(tidyverse)
library(patchwork)
```

# Results

## Overview of Employment Statistic

Before we dive into the questions about the factors influencing the employment, it would be better that we have an overview of overall civilian labor force in order to understand the data following more clearly.

```{r, echo=FALSE, fig.width=10}
overall_workforce_change <- read_excel("clean_data/overall_workforce_change.xlsx")

g1 <- ggplot(overall_workforce_change, aes(x = Year)) +
  geom_line(aes(y = `Civilian noninstitutional population`, color="Civilian Noninstitutional Population")) +
  geom_line(aes(y = `Civilian labor force_Total`, color="Civilian Labor Force")) +
  geom_line(aes(y = `Civilian labor force_Employed_Total`, color="Civilian Labor Force Employed")) +
  geom_line(aes(y = `Civilian labor force_Unemployed_Number`, color="Civilian Labor Force Unemployed")) +
  ggtitle("Civilian Noninstitutional Population and Labor Force") +
  labs (x = "Year", y = "Thousands of Persons")
g1
```

Here, Civilian Noninstitutional Population is defined as persons 16 years of age and older residing in the 50 states and the District of Columbia, who are not inmates of institutions (e.g., penal and mental facilities, homes for the aged), and who are not on active duty in the Armed Forces. Civilian Labor Force is defined as all persons in the civilian noninstitutional population classified as either employed or unemployed. The detailed definition of person's employment state can be found [here](https://webapps.dol.gov/dolfaq/go-dol-faq.asp?faqid=111&topicid=6).

As we can see, Civilian Noninstitutional Population keeps increasing over time, as same as Civilian Labor Force and Civilian Labor Force Employed.

```{r, echo=FALSE, fig.width=10}
g2 <- ggplot(overall_workforce_change, aes(x = Year)) +
  geom_line(aes(y = `Civilian labor force_Percent of population`, color="Civilian Labor Force")) +
  geom_line(aes(y = `Civilian labor force_Employed_Percent of population`, color="Civilian Labor Force Employed")) +
  geom_smooth(aes(y = `Civilian labor force_Percent of population`)) +
  geom_smooth(aes(y = `Civilian labor force_Employed_Percent of population`)) +
  ggtitle("Civilian Labor Force Percentage") +
  labs (x = "Year", y = "Percent")
g2
```

The percentage here is calculated by dividing population of Civilian Labor Force and Civilian Labor Force Employed with Civilian Noninstitutional Population. The first statistic also can be referred as Labor Force Participation Rate.

Both lines of percentage show a similar pattern. Despite of the increasing trend in overall population, the percentage of Civilian Labor Force and Civilian Labor Force Employed reach peak at 2000 and then decreased.

A detailed analysis of Labor Force Participation Rate can be find [here](https://www.investopedia.com/terms/p/participationrate.asp), which is not the topic we tend to discuss here. It should be noticed that Labor Force Participation Rate is influenced by social, demographic, and economic trends. Therefore, it's complicated to explain the change of this statistic over time.

```{r, echo=FALSE, fig.width=10}
g3 <- ggplot(overall_workforce_change, aes(x = Year, y = `Civilian labor force_Unemployed_Percent of labor force`)) +
  geom_line() +
  geom_smooth() +
  ggtitle("Unemployed Rate") +
  labs (x = "Year", y = "Unemployed Rate")
g3
```

The Unemployment Rate is defined by the ratio of unemployed to the civilian labor force expressed as a percent [i.e., 100 times (unemployed/labor force)]. Therefore, the Unemployment Rate indicates what degree of people who try but can not find a job.

As we can see, the Unemployment Rate changes rapidly over time and in 2020 it reached another peak again. Despite the constant change over time, the Unemployment Rate hovers around 6% in general.

## Discrimination in Employment

Now we want to find out whether it exists discrimination in employment in different industries in recent period.

### Sex Discrimination

First we examine the sex discrimination. 

```{r, echo=FALSE, fig.width=10, fig.height = 12}
men_vs_women_over_20_years <- read_excel("clean_data/question_01/men_vs_women_over_20_years.xlsx")
X2020 <- read_excel("clean_data/question_01/occupation_sex_race/detailed/2020.xlsx")

g4 <- ggplot(men_vs_women_over_20_years, aes(x = Year, y = Civilian_labor_force_Employed_Percent_of_population, color = Group)) +
  geom_line() +
  ggtitle("Civilian Labor Force Employed Percent of Population") +
  labs (x = "Year", y = "Percent")
g4_1 <- ggplot(men_vs_women_over_20_years, aes(x = Year, y = Civilian_labor_force_Percent_of_population, color = Group)) +
  geom_line() +
  ggtitle("Civilian Labor Force Percent of Population") +
  labs (x = "Year", y = "Percent")
g4_2 <- ggplot(men_vs_women_over_20_years, aes(x = Year, y = Civilian_noninstitutional_population, color = Group)) +
  geom_line() +
  ggtitle("Civilian Noninstitutional Population") +
  labs (x = "Year", y = "Thousands of Persons")
g4_3 <- ggplot(men_vs_women_over_20_years, aes(x = Year, y = Civilian_labor_force_Unemployed_Percent_of_labor_force, color = Group)) +
  geom_line() +
  ggtitle("Unemployed Rate") +
  labs (x = "Year", y = "Unemployed Rate")
g4_2 + g4_1 + g4 + g4_3 + plot_layout(ncol = 1)
```

From a whole review, we can see that women significantly had less Civilian Labor Force Percent and Labor Force Employed Percent of population, despite the increasing of Civilian Noninstitutional Population over time. It indicates that women are likely not to have a job or try to pursue a job compared with men, which shows discrimination in the overall employment. The graph also shows that the gap in Civilian Labor Force Percent between men and women has been narrowed in recent years, indicating the situation may be changing to a good way.

However, as the last graph suggests, the Unemployment Rate for men and women shows a very similar pattern. Actually, the Unemployment Rate for women always shows a little bit less than men. This shows that it's not more difficult for women to find a job if they want to in the overall picture of employment.

Next let's try to examine the sex discrimination in different occupation.

```{r, echo=FALSE, fig.width=10, fig.height=10}
rX2020 <-  X2020 %>% 
  filter(`Total Employed` > 1000) %>%
  arrange(desc(`Percent of total employed_women`))
g5 <- ggplot(rX2020, aes(x=fct_reorder(Occupation, `Percent of total employed_women`))) +
  geom_bar(aes(y=`Total Employed`), stat="identity", size=.1, color="black", alpha=.4) + 
  geom_point(aes(y=`Percent of total employed_women`/0.003), stat="identity", color="blue") +
  scale_y_continuous(
    # Features of the first axis
    name = "Thousands of Persons",
    # Add a second axis and specify its features
    sec.axis = sec_axis(~.*0.003, name="Percent")
  ) + 
  ggtitle("Total Employed and Women Percent (Sorted by Percent)") +
  xlab("Occupation") +
  coord_flip()
g5
```

Here we only display the occupations which have total employed population over 1MM, due to the large number of occupations. Data was collected in 2020, which shows the recent state of total employee and percent of women employee.

From the graph we can find that there is a strong sex preference in a lot of occupations. For example, secretary and administrative assistant have a very strong tendency to women, which have over 90% of women employee. While in occupations related to construction, the percent of women employee is pretty low.

Some discrimination in the graph may be explained reasonably. For example, construction laborers has a strong preference to men because the work requires strong physical labor and apparently it fits to men physically. Occupation of elementary and middle school teachers has a strong tendency to women, which may be resulted from the social common sense that women are more patient, considerate and obviously better at looking after children. However, such explains also indicate that the discrimination towards sex has deeply rooted at the culture and social common sense, which tell people what men should do and women should do.

Besides, there are some occupations with discrimination towards sex, which can not be explained easily, such as software developers, computer and mathematical occupations, which have a tendency to men; bookkeeping, accounting and auditing clerks have a strong tendency to women.

### Race Discrimination

Now we focus on the discrimination towards races.

```{r, echo=FALSE, fig.width=10, fig.height=10}
r2X2020 <-  X2020 %>% 
  filter(`Total Employed` > 1000) %>%
  arrange(desc(`Percent of total employed_Asian`))
g6 <- ggplot(rX2020, aes(x = fct_reorder(Occupation, `Percent of total employed_Asian`))) +
  geom_bar(aes(y=`Total Employed`), stat="identity", size=.1, alpha=.3) + 
  geom_point(aes(y = `Percent of total employed_Asian`/0.003, color="Asian")) +
  geom_point(aes(y = `Percent of total employed_White`/0.003, color="White")) +
  geom_point(aes(y = `Percent of total employed_Black or African American`/0.003, color="Black")) +
  geom_point(aes(y = `Percent of total employed_Hispanic or Latino`/0.003, color="Hispanic or Latino")) +
  scale_y_continuous(
    # Features of the first axis
    name = "Thousands of Persons",
    # Add a second axis and specify its features
    sec.axis = sec_axis(~.*0.003, name="Percent")
  ) + 
  ggtitle("Total Employed and Races Percent (Sorted by Asian Percent)") +
  labs (x = "Occupation", y = "Percent of Total Employed") +
  coord_flip()
g6
```

Again we only display the occupations which have total employed population over 1MM, due to the large number of occupations. Data was collected in 2020, which shows the recent state of total employee and percent of employee of different races.

We can find out that there is discrimination in different occupations, and the degree of it varies according to the occupation. Occupations related to computer science have a strong tendency to Asian compared with other occupations. If we read the graph carefully, we can find that Asian tend to have occupations with higher requirements of professional knowledge, especially related to field of science, engineering and finance.

We can also observe that percent of Asian employee has a negative correlation with percent of White and Hispanic or Latino employee, but doesn't seem to have a correlation with percent of Black or African American employee.

This phenomenon can be explained by saying that in the recent decades many Asian come to the U.S. to pursue a Master or PHD degree, who tend to stay in the U.S. and continue their career. Still, the discrimination exists.

## Change of Employment Situation

Now we want to answer a question: How does the employment situation change in the recent years? Is there any improvement about employment in different industries?

We can answer the first question according to the graph at first part. Civilian Noninstitutional Population keeps increasing over time, while the Labor Force Participation Rate reached peak at 2000 and then kept decreasing until now. The Unemployment Rate changes rapidly over time and in 2020 it reached another peak again. Despite of the constant change over time, the Unemployment Rate hovers around 6% in general.

The conclusions above suggest that on the whole, the employment situation doesn't improve, and may change rapidly due to external factors, such as COVID-19 and Great Recession.

Now we want to examine the employment situation in different industries in recent years.

```{r, echo=FALSE, fig.width=15, fig.height=10}
Total_unemployed_number <- read_excel("clean_data/question_02/Total_unemployed_number.xlsx")
Unemployment_rate_sex_occupation_ <- read_excel("clean_data/question_02/Unemployment_rate(sex_occupation).xlsx")

df1 <- Total_unemployed_number %>%
  pivot_longer(-c(Occupation, Group), names_to="Year", values_to="Population")
df1$Occupation <- substr(df1$Occupation, 1, nchar(df1$Occupation)-12)
ggplot(df1, aes(x=Year, y=Population, group=1, color="Red")) +
  geom_line(size = 1) +
  geom_point(size = 2) +
  facet_wrap( ~ Occupation, scale = 'free', ncol=4) +
  theme_bw() +
  labs(title = "Total Unemployment Population in 2016-2020", y = "Thousands of Persons") +
  theme(legend.position = "none",
        plot.title = element_text(hjust = .5))

```

The figure above displays the total unemployed population in recent 5 years in different occupations. Although different occupations have different degree of population, the trend looks consistent.

We can see that almost all occupations share a same pattern: the unemployed population decrease slowly from 2016 to 2019, and then rapidly increase in 2020. Occupation about arming, fishing and forestry seems to be an exception, which increased a little in 2019 but decreased in 2020.

The reason behind rapid increasing in 2020 is well known to everyone: COVID-19. It's good to see that before 2020 the unemployment population have an overall deceasing trend in most occupations, which suggests a good trend in the employment situation. 

```{r, echo=FALSE, fig.width=15, fig.height=10}
df2 <- Unemployment_rate_sex_occupation_ %>%
  pivot_longer(-c(Occupation, Group))

df2$Year <- substr(df2$name, 1, 4)
df2$Sex <- substr(df2$name, 6, nchar(df2$name))
df2 <- select(df2, -name)

df2 <- df2 %>%
  pivot_wider(names_from=Sex, values_from=value)

ggplot(df2, aes(x=Year, group=1))+
  geom_line(aes(y=Total, color="Total"), size = 1) +
  geom_point(aes(y=Total, color="Total"), size = 2) +
  geom_line(aes(y=Men, color="Men"), size = 1) +
  geom_point(aes(y=Men, color="Men"), size = 2) +
  geom_line(aes(y=Women, color="Women"), size = 1) +
  geom_point(aes(y=Women, color="Women"), size = 2) +
  facet_wrap( ~ Occupation, scale = 'free', ncol=4) +
  theme_bw() +
  labs(title = "Unemployment Rate in 2016-2020", y = "Percent") +
  theme(legend.position = "bottom",
        plot.title = element_text(hjust = .5))

```

The graph above display the Unemployed Rate of total, men and women.

The trend here is similar with the previous graph. Since we use the Unemployment Rate, we can now compare the employment situation between different occupations. For example, we can find that food preparation and serving related occupation suffered most in 2020 due to COVID-19 and people tend to stay at home instead of eating outside at restaurant. 

Besides, we can not find an obvious relation between Unemployment Rate of men and women, except they share a similar pattern due to external factors. According to the graph, the difference varies between different occupations.